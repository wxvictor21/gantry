{% extends "base.html" %}

{% block content %}
<h1>Mover cámara</h1>

<form id="moveForm">
  X: <input type="number" step="1" id="x" name="x">
  Y: <input type="number" step="1" id="y" name="y">
  <button type="submit">Mover y capturar</button>
</form>

<h2>Última foto</h2>
<div>
  <img id="lastPhoto" src="/latest_photo" width="640">
</div>

<h3>Resultado del comando</h3>
<pre id="result"></pre>

<script>
document.getElementById("moveForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const x = document.getElementById("x").value;
  const y = document.getElementById("y").value;

  const res = await fetch("/move", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({x, y})
  });

  const data = await res.json();
  document.getElementById("result").textContent = JSON.stringify(data, null, 2);

  if (data.photo_url) {
    document.getElementById("lastPhoto").src = data.photo_url + "?t=" + Date.now();
  }
});
</script>
{% endblock %}
